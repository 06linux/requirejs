/*
 Copyright (c) 2004-2010, The Dojo Foundation All Rights Reserved.
 Available via the MIT, GPL or new BSD license.
 see: http://github.com/jrburke/runjs for details
*/
(function(){function p(a){return q.call(a)==="[object Function]"}function t(a,b,d,c,e,f){var i,h,j;if(a&&a.length>0)for(j=0;i=a[j];j++)if((h=c[c[i]])&&!h.isOrdered)if(!e[i]){b.push(h);if(h.name)b[h.name]=true;r(b,d,c,e,f)}}function r(a,b,d,c,e){for(var f;a.length>0;){if((f=a[a.length-1])&&!f.isOrdered){f.isOrdered=true;t(f.deps,a,b,d,c,e);b.push(f)}a.pop()}}var n={},g,k,u=[],l,m,s,v=/complete|loaded/;l=!!(typeof window!=="undefined"&&navigator&&document);var q=Object.prototype.toString;if(typeof run!==
"undefined")if(p(run))return;else k=run;this.run=function(a,b,d,c){var e=null,f,i,h,j;if(typeof a==="string"){f=a.indexOf("!");if(f!==-1){h=a.substring(0,f);a=a.substring(f+1,a.length)}if(!run.isArray(b)){c=d;d=b;b=[]}c=c||g.ctxName;if((f=g.contexts[c])&&(f.defined[a]||f.waiting[a]))return run}else if(run.isArray(a)){c=d;d=b;b=a;a=null}else if(run.isFunction(a)){d=a;c=b;a=null;b=[]}else{e=a;a=null;if(run.isFunction(b)){c=d;d=b;b=[]}c=c||e.context}c=c||g.ctxName;f=g.contexts[c];if(!f){f={contextName:c,
config:{waitSeconds:7,baseUrl:g.baseUrl||"./",paths:{}},waiting:[],specified:{run:true},loaded:{run:true},defined:{},modifiers:{}};f.defined.run=run;f=g.contexts[c]=f}if(e){if(e.baseUrl)if(e.baseUrl.charAt(e.baseUrl.length-1)!=="/")e.baseUrl+="/";j=f.config.paths;run.mixin(f.config,e,true);if(e.paths){for(i in e.paths)i in n||(j[i]=e.paths[i]);f.config.paths=j}if(!b)return run}e=f.waiting.push({name:a,deps:b,callback:d});if(a){f.waiting[a]=e-1;f.specified[a]=true}if(a&&d&&!run.isFunction(d))f.defined[a]=
d;if(g.paused)g.paused.push([h,a,b,f]);else{run.checkDeps(h,a,b,f);run.checkLoaded(c)}return run};run.get=function(a,b){b=b||g.ctxName;var d=g.contexts[b].defined[a];if(d===undefined)throw new Error("run.get: module name '"+a+"' has not been loaded yet for context: "+b);return d};run.mixin=function(a,b,d){for(var c in b)if(!(c in n)&&(!(c in a)||d))a[c]=b[c];return run};run.global=this;run.version="0.0.6";g=run.s={ctxName:"_",contexts:{},isBrowser:l,isPageLoaded:!l,pageCallbacks:[],doc:l?document:
null};k&&run.mixin(g,k,true);g.head=g.head||l?g.doc.getElementsByTagName("head")[0]||g.doc.getElementsByTagName("html")[0]:null;run.isBrowser=g.isBrowser;run.doc=g.doc;if(run.isBrowser&&!g.baseUrl){l=run.doc.getElementsByTagName("script");s=/run\.js(\W|$)/i;for(k=l.length-1;m=l[k];k--)if(m=m.getAttribute("src")){if(k=m.match(s))g.baseUrl=m.substring(0,k.index);break}}run.pause=function(){if(!g.paused)g.paused=[]};run.resume=function(){var a,b,d;if(g.paused){d=g.paused;delete g.paused;for(a=0;b=d[a];a++)run.checkDeps.apply(run,
b)}run.checkLoaded(g.ctxName)};run.checkDeps=function(a,b,d,c){var e;if(!a)for(a=0;b=d[a];a++)if(typeof b==="string"){if(!c.specified[b]){c.specified[b]=true;e=b.indexOf("!");e===-1&&run.load(b,c.contextName)}}else throw new Error("Unsupported non-string dependency: "+b);};run.isArray=function(a){return q.call(a)==="[object Array]"};run.isFunction=p;run.load=function(a,b){var d=g.contexts[b],c;d.loaded[a]=false;c=run.convertNameToPath(a,b);run.attach(c,b,a);d.startTime=(new Date).getTime()};run.jsExtRegExp=
/\.js$/;run.convertNameToPath=function(a,b,d){var c,e,f;b=g.contexts[b].config;if(run.jsExtRegExp.test(a))return a;else{c=b.paths;if(b.dotsAsSlashes)a=a.replace(/\./g,"/");a=a.split("/");for(e=a.length;e>0;e--){f=a.slice(0,e).join("/");if(c[f]){a.splice(0,e,c[f]);break}}d=a.join("/")+(d||".js");return(d.charAt(0)==="/"||d.match(/^\w+:/)?"":b.baseUrl)+d}};run.checkLoaded=function(a){var b=g.contexts[a||g.ctxName],d=b.config.waitSeconds*1E3;d=d&&b.startTime+d<(new Date).getTime();var c=b.loaded,e="",
f=false,i=false,h;if(!b.isCheckLoaded){b.isCheckLoaded=true;for(h in c)if(!(h in n)){f=true;if(!c[h])if(d)e+=h+" ";else{i=true;break}}if(!f&&!b.waiting.length)b.isCheckLoaded=false;else{if(d)throw new Error("run.js load timeout for modules: "+e);if(i){b.isCheckLoaded=false;run.isBrowser&&setTimeout(function(){run.checkLoaded(a)},50)}else{h=b.waiting;b.waiting=[];b.loaded={};c=[];for(d=0;e=h[d];d++){f=[e];if(e.name)f[e.name]=true;r(f,c,h,b.defined,b.modifiers)}run.callModules(a,b,c);b.isCheckLoaded=
false;if(b.waiting.length)run.checkLoaded(a);else if(!u.length)g.ctxName="_"}}}};run.callModules=function(a,b,d){var c,e,f,i,h,j,o;for(h=0;c=d[h];h++){a=c.name;f=c.deps;i=[];for(j=0;e=f[j];j++){o=e.indexOf("!");if(o!==-1)e=e.substring(o+1,e.length);e=b.defined[e];i.push(e)}if((c=c.callback)&&run.isFunction(c)){i=c.apply(run.global,i);if(a)if((c=b.defined[a])&&i)throw new Error(a+" has already been defined");else b.defined[a]=i}}};run.onScriptLoad=function(a){var b=a.target||a.srcElement,d;if(a.type===
"load"||v.test(b.readyState)){a=b.getAttribute("data-runcontext");d=b.getAttribute("data-runmodule");g.contexts[a].loaded[d]=true;run.checkLoaded(a);b.removeEventListener?b.removeEventListener("load",run.onScriptLoad,false):b.detachEvent("onreadystatechange",run.onScriptLoad)}};run.attach=function(a,b,d){if(run.isBrowser){var c=run.doc.createElement("script");c.src=a;c.type="text/javascript";c.charset="utf-8";c.setAttribute("data-runcontext",b);c.setAttribute("data-runmodule",d);c.addEventListener?
c.addEventListener("load",run.onScriptLoad,false):c.attachEvent("onreadystatechange",run.onScriptLoad);return g.head.appendChild(c)}return null}})();